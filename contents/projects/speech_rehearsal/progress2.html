
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Progress 2: Security &amp; Hosting on AWS &#8212; Machine Learning Notes</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://note.notmlprojects.com/contents/projects/speech_rehearsal/progress2.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-SN82SMEHZ2"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-SN82SMEHZ2');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Machine Learning Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Concepts
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../fundamentals/content.html">
   Fundamentals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../fundamentals/entropy/content.html">
     Entropy
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../modeling/content.html">
   Modelings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../modeling/res_net/content.html">
     Residual Network
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../modeling/mobile_net/content.html">
     MobileNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../modeling/efficient_net/content.html">
     EfficientNet
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../modeling/vision_transformer/content.html">
     Vision Transformer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../modeling/wav2vec2/content.html">
     Wav2Vec 2.0
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../metrics/content.html">
   Metrics
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../metrics/angular_similarity/content.html">
     Angular Similarity
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tips_and_tricks/content.html">
   Tips and Tricks
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tips_and_tricks/nan_on_training/content.html">
     NaN on Training
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../applications/content.html">
   Applications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../applications/wav2vec2_phoneme/content.html">
     Wav2Vec2 for Phoneme
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tools and Frameworks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../tools_and_frameworks/tensorflow/content.html">
   Tensorflow
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../tools_and_frameworks/tensorflow/demystifying_tf_data/content.html">
     Demystifying tf.Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tools_and_frameworks/sagemaker/content.html">
   AWS Sagemaker
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Projects
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="content.html">
   Speech Rehearsal
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/contents/projects/speech_rehearsal/progress2.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#date-june-13-july-02">
   Date: June 13 - July 02
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-objective">
   Main Objective
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-experience-improvement">
   I. Experience Improvement
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#improve-the-feedback-ux">
     <strong>
      Improve the Feedback UX
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-loading-screen">
     <strong>
      Change Loading Screen
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#threshold-and-normalization">
     <strong>
      Threshold and Normalization
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ii-hosting-on-aws">
   II. Hosting on AWS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cloudfront-s3">
     <strong>
      CloudFront + S3
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambda-function">
     <strong>
      Lambda Function
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#api-gateway">
     <strong>
      API Gateway
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iii-protecting-your-api-key">
   III. Protecting Your API Key
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-token">
     <strong>
      Using Token
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cross-origin-resource-sharing-cors">
     <strong>
      Cross-Origin Resource Sharing (CORS)
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contextual-authentication">
     <strong>
      Contextual Authentication
     </strong>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Progress 2: Security & Hosting on AWS</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#date-june-13-july-02">
   Date: June 13 - July 02
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#main-objective">
   Main Objective
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-experience-improvement">
   I. Experience Improvement
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#improve-the-feedback-ux">
     <strong>
      Improve the Feedback UX
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-loading-screen">
     <strong>
      Change Loading Screen
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#threshold-and-normalization">
     <strong>
      Threshold and Normalization
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ii-hosting-on-aws">
   II. Hosting on AWS
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cloudfront-s3">
     <strong>
      CloudFront + S3
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lambda-function">
     <strong>
      Lambda Function
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#api-gateway">
     <strong>
      API Gateway
     </strong>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iii-protecting-your-api-key">
   III. Protecting Your API Key
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-token">
     <strong>
      Using Token
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cross-origin-resource-sharing-cors">
     <strong>
      Cross-Origin Resource Sharing (CORS)
     </strong>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#contextual-authentication">
     <strong>
      Contextual Authentication
     </strong>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="progress-2-security-hosting-on-aws">
<h1>Progress 2: Security &amp; Hosting on AWS<a class="headerlink" href="#progress-2-security-hosting-on-aws" title="Permalink to this headline">#</a></h1>
<section id="date-june-13-july-02">
<h2>Date: June 13 - July 02<a class="headerlink" href="#date-june-13-july-02" title="Permalink to this headline">#</a></h2>
</section>
<section id="main-objective">
<h2>Main Objective<a class="headerlink" href="#main-objective" title="Permalink to this headline">#</a></h2>
<p>The ultimate goal for these two weeks is the following:</p>
<ul class="simple">
<li><p>Improving the interface and system to be more user-friendly</p></li>
<li><p>Switch to hosting on AWS instead of on Azure Cloud</p></li>
<li><p>Deal with security aspects during the hosting</p></li>
</ul>
</section>
<section id="i-experience-improvement">
<h2>I. Experience Improvement<a class="headerlink" href="#i-experience-improvement" title="Permalink to this headline">#</a></h2>
<section id="improve-the-feedback-ux">
<h3><strong>Improve the Feedback UX</strong><a class="headerlink" href="#improve-the-feedback-ux" title="Permalink to this headline">#</a></h3>
<p>Previously, we show both the user audio’s phoneme and the actual expected one. In this case, it is very transparent for users to know what is going on behind the scene. However, after some trial attempts, we find out that it can be somewhat confusing due to the limitation of (i) the audio-to-phoneme model and (ii) the phoneme alignment algorithm.</p>
<p>Then, we decide to make this easier to work with. We only show the expected output along with some feedback on which part needs to be worked on further. We find this to be easier to understand than the former one.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p>Before</p></th>
<th class="text-align:center head"><p>After</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p><img alt="" src="../../../_images/w2_feedback_old.png" /></p></td>
<td class="text-align:center"><p><img alt="" src="../../../_images/w2_feedback_new.png" /></p></td>
</tr>
</tbody>
</table>
</section>
<section id="change-loading-screen">
<h3><strong>Change Loading Screen</strong><a class="headerlink" href="#change-loading-screen" title="Permalink to this headline">#</a></h3>
<p>Initially, we try to get the early prototype out the door. We chose to block the entire screen with a loading circle when the user clicks analyze. This means that users should have to do absolutely nothing for about 1 minute staring at nothing but a circle.</p>
<p>Note that this takes that long because of HuggingFace loading time. Actually, we can make the HuggingFace model available 24/7 for 30USD a month, but we chose not to do so because this is still in an early MVP.</p>
<p>Anyway, we replace that circle with a progress bar and block other functionality like editing the text or analyze button. In this case, users can read the text or listen to their own voices while waiting.</p>
<p><img alt="Progress Bar" src="../../../_images/w2_progress_bar.png" /></p>
</section>
<section id="threshold-and-normalization">
<h3><strong>Threshold and Normalization</strong><a class="headerlink" href="#threshold-and-normalization" title="Permalink to this headline">#</a></h3>
<p>We realize that there are some mismatches between phonemes from transcription (audio2phoneme) using <strong>the Transformer model</strong> and from the text (text2phoneme) using <strong>espeak-ng</strong>. Hence, we revisit the material based on <a class="reference external" href="https://en.wikipedia.org/wiki/ARPABET">https://en.wikipedia.org/wiki/ARPABET</a>. We manually convert phoneme that only exists on espeak-ng and map that to the closest phoneme in Transformer.</p>
<p>Note that during training audio2phoneme, we group and similar some phonemes into only a collection of 39 phonemes (based on a research paper).</p>
<p>We also change the threshold for the score. Word with a score above 65% will be marked as green. 25% upward is considered orange. Setting a more strict threshold can de-motivate users from learning and improving.</p>
<p>For future notes, we are thinking of letting users set their difficulties. And the threshold would be reflected based on that preference.</p>
</section>
</section>
<section id="ii-hosting-on-aws">
<h2>II. Hosting on AWS<a class="headerlink" href="#ii-hosting-on-aws" title="Permalink to this headline">#</a></h2>
<p>Initially, we hosted on the Azure cloud because this was a part of a Microsoft Responsible AI hackathon. And the Azure cloud is the requirement for the submission. So, after the hackathon, we switch back to AWS cloud service.</p>
<p><img alt="Overview for an Architecture on AWS" src="../../../_images/w2_aws_architecture.png" /></p>
<p>Overview for an Architecture on AWS</p>
<p>This is our first time trying to put all these different services onto AWS. It’s pretty interesting. Let us walk through each component. Note that we are trying to minimize the expense as much as possible because we don’t know how much traffic we will be serving.</p>
<section id="cloudfront-s3">
<h3><strong>CloudFront + S3</strong><a class="headerlink" href="#cloudfront-s3" title="Permalink to this headline">#</a></h3>
<p>Previously, we dockerize NuxtJS application (based on VueJS) into a container. This would hold both frontend and express-based backend. It was pretty easy to work with. However, hosting that on AWS can bare some costs on idling. If we put the container into the lambda function, the load is too heavy. A user would have to stare at the blank screen for 4 to 10 seconds as the container is booting up before they can press anything.</p>
<p>Therefore, we split the NuxtJS into two separate components - static and backend. The NuxtJS is based on VueJS which can be considered a single-page application. We take the SPA static and put it into an S3 bucket. Who could have thought we can use an S3 bucket to host a static webpage? Considering this is a SPA, it’s just perfect.</p>
<p>Then, we incorporate that with <strong>CloudFront</strong>. This service is a CDN. Making serving S3 content a lot faster and it also enables HTTPS connection. So pretty much, it handles everything for us.</p>
</section>
<section id="lambda-function">
<h3><strong>Lambda Function</strong><a class="headerlink" href="#lambda-function" title="Permalink to this headline">#</a></h3>
<p>As for the backend, it’s pretty lightweight so we put that into a lambda function, which we named Centralized Backend. Essentially, it just forwards or calls the subsequent services (i.e.g, Text2Phoneme, and HuggingFace). This way, our SPA does not need to be aware of all the services. Just one is enough. Also, we don’t want to risk exposing sensitive API keys from Text2Phoneme or HuggingFace service to the frontend.</p>
</section>
<section id="api-gateway">
<h3><strong>API Gateway</strong><a class="headerlink" href="#api-gateway" title="Permalink to this headline">#</a></h3>
<p>This backend is connected with APIGateway, which helps manage the API key, throttle, limit the requests, validation requests, and so on. It makes API management much more convenient.</p>
<p>One downside is <strong>it has some restrictions</strong>. It blocks binary file content type which we need to enable manually. Also, it converts the binary to base64 before passing it to the downstream API. To mitigate this, we can:</p>
<ul class="simple">
<li><p>Add another lambda function to facilitate this mapping</p></li>
<li><p>Change our API itself</p></li>
<li><p>Modify the request in APIGateway which utilizes a different syntax that takes extra time.</p></li>
</ul>
<p>Or we can just set the APIGateway to act as <strong>a proxy</strong> which would just forward the request entirely. Doing so, however, we can’t even modify the request. For example, we want to add an authentication key to the header because the downstream API needs and the frontend or clients are not aware of that. Again, a separate lambda function would be needed.</p>
<p>While APIGateway helps the management of API, we find it quite cumbersome.</p>
</section>
</section>
<section id="iii-protecting-your-api-key">
<h2>III. Protecting Your API Key<a class="headerlink" href="#iii-protecting-your-api-key" title="Permalink to this headline">#</a></h2>
<p>This is still a big question about how we should secure our API key. A rule of thumb is that anything that exists in the frontend is not secure. Anything at all is accessible and readable.</p>
<p>Sensitive API keys, for example, HuggingFace or Text2Phoneme API, should not be placed in the frontend. In other words, the frontend or client should not be aware of that. Hence, we have a centralized server for this particular purpose.</p>
<p>But <strong>how do we protect the connection</strong> between the client and that centralized backend server?</p>
<section id="using-token">
<h3><strong>Using Token</strong><a class="headerlink" href="#using-token" title="Permalink to this headline">#</a></h3>
<p>Usually, we would require a user to authenticate. That user will own a specific token, for example, JWT, that would need to pass to the backend for authentication and authorization the access to the backend. Also, we can add restrictions and limitations per user. It makes things more manageable. So even if the user has ill-intention of getting that JWT token and using it in their application, there are still some restrictions on how much they can use it. <strong>Note that they can still access it from elsewhere.</strong></p>
<p>Our use cases, however, are unique. We want users to be able to interact with our system without having to register or log in. We can still issue a token for the browser and set a shorter expiry limit. Again, they can still use the token from Postman or directly from using curl request.</p>
<p>There are some other security measures. But do keep in mind that, whatever the method may be, if a user attempts to access your server, there is always a way. We just need to pray that they don’t target us. 😩</p>
</section>
<section id="cross-origin-resource-sharing-cors">
<h3><strong>Cross-Origin Resource Sharing (CORS)</strong><a class="headerlink" href="#cross-origin-resource-sharing-cors" title="Permalink to this headline">#</a></h3>
<p>The whole idea of this is that <strong>users can not integrate or embedded your API directly on their webpage</strong>. What cors does is that it checks if the requesting domain (the one calling the server) has access to the resources.</p>
<p>It can happen on both the browser and backend. The backend expects a header origin passing in the request. The server then knows which domain the request is coming from. The browser will set that by default. And it is impossible to modify that header in the browser. Hence, if a user calls your endpoint from another website, two things can happen. Your server can check the header and reject immediately if the origin is unknown. Or your server can return a response header indicating which domain is allowed. Then, the browser will be the judge of that. If the request header (origin) and the response header (allow origin) do not match, the response will be rejected.</p>
<p>Although this CORS mechanism can protect on the frontend, a request made using Postman or from the server-side, such headers can be easily manipulated. In other words, <strong>CORS can protect your endpoint resources from being called from unauthorized web pages</strong>.</p>
</section>
<section id="contextual-authentication">
<h3><strong>Contextual Authentication</strong><a class="headerlink" href="#contextual-authentication" title="Permalink to this headline">#</a></h3>
<p>Not sure if this is the right term, but the idea here is to set the context in which the request is sent. For instance, the origin referer in the CORS above is definitely one thing. It can also be a region of the client, browser information, a platform they are using, and all that. Again, this does not stop users from guessing the correct information. It just makes things harder.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./contents/projects/speech_rehearsal"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Vitou Phy<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>